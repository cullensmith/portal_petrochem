<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset=utf-8 />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FracTracker Petrochem Data Portal</title>
    <link rel="icon" type="image/png" href="/static/images/ft2021_logo_icon_dark_blue_small.png">

    <!-- Include Project Specific CSS -->

    {% comment %} <link rel = "stylesheet" href = "/static/css/filtering.css"/> {% endcomment %}
    
    <link rel = "stylesheet" href = "/static/css/map.css"/>
    <link rel = "stylesheet" href = "/static/css/table.css"/>

    <!-- Include Leaflet CSS and JavaScript -->
    {% comment %} <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" /> {% endcomment %}
    <link rel = "stylesheet" href = "/static/css/leaflet.css"/>

    <link rel="stylesheet" href="https://cdn.rawgit.com/mapbox/supercluster/v4.0.1/demo/cluster.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/supercluster@4.0.1/dist/supercluster.js"></script>
    {% comment %} <script src="https://code.jquery.com/jquery-1.12.4.js"></script> {% endcomment %}
    <!-- for the underscore variable/js function-->
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/lodash.js/0.10.0/lodash.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Include jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>

    {% comment %} <link rel = "stylesheet" href = "/static/css/leaflet-draw.css"/> {% endcomment %}
    {% comment %} <script src="/static/js/leaflet-draw.js"/></script> {% endcomment %}

    <link rel="stylesheet" href="https://unpkg.com/leaflet-draw@1.0.4/dist/leaflet.draw.css" />
    <script src="https://unpkg.com/leaflet-draw@1.0.4/dist/leaflet.draw.js"></script>

    <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />
    <script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>
    <!-- geojson vt  -->
    <script src="https://unpkg.com/geojson-vt@3.2.0/geojson-vt.js"></script>
    <script src="https://unpkg.com/leaflet-geojson-vt@1.1.0/src/leaflet-geojson-vt.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script src="https://cdn.jsdelivr.net/npm/@turf/turf@6.5.0"></script>

    <link href="https://fonts.googleapis.com/css2?family=Archivo&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Archivo+Black&display=swap" rel="stylesheet">

    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
    
    {% comment %} <!-- EasyPrint CSS and JS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet-easyprint@2.1.9/dist/bundle.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/leaflet-easyprint@2.1.9/dist/bundle.min.js"></script> {% endcomment %}



    <style>
      
        
        .print-btn {
            background-color: red;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin: 0 10px;
        }
        
        .print-btn:hover {
            background-color: red;
        }
        
        .print-btn:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        

        
        /* Print preview modal */
        .print-modal {
            display: none;
            position: fixed;
            z-index: 10000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
        }
        
        .print-content {
            position: relative;
            margin: 2% auto;
            width: 80%;
            height: 90%;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
        }
        
        .print-map {
            width: 100%;
            height: 80%;
            border: 1px solid #ddd;
        }
        
        .print-header {
            text-align: center;
            margin-bottom: 15px;
        }
        
        .print-actions {
            text-align: center;
            margin-top: 15px;
        }
        




        .screenshot-btn {
            font-family: 'Archivo Black'; 
            font-size:18px;
            background-color: #a3cf5f;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin: 0 5px;
        }
        
        .screenshot-btn:hover {
            background-color: #a3cf5f;
        }
        
        .screenshot-btn:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        
        .close-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
        }


        /*
        colors:
         dark blue - 02253a
         fractracker blue - 025687
         light blue - 0287D4
         green - A3CF5F 
         light gray - FDFFFC 

        */


        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;

        }
        
        html, body {
            height: 100%;
            font-family: Arial;
        }
        .body{
            flex: 1;  
        }
        .container {
            display: flex;
            flex-direction: column;
            height: 100%;       /* 100% of viewport height */
          }
        /* Header styling */
        header {
            height: 100px;
            {% comment %} width: 100%; {% endcomment %}
            background-color: white; /*#0287D4;*/
            color: #025687;
            display: grid;
            justify-content: left;
            margin-left: 110px;
            font-size: 24px;
        }

        /* Main content styling */
        .main-content {
            display: flex;
            height: calc(100vh - 90px); /* Subtract header height */
        }
        /* Right side */
        .right {
          /* flex-grow: 1; */
          /* height: 100%; */
          width: 100%;
          overflow-x: auto;

        }
        #container {
          height: 100%;
          display: flex;
          flex-direction: column;
        }
        #dividerContainer {
            cursor: ns-resize;
            background-color: #02253a;;
            height: 40px;
            width: 100%;
            user-select: none;
            border-top-right-radius:12px;
            border-top-left-radius:12px;
          }
        #loading-popupid {
            display: none
        }


                
        /* Left side panel*/
        .left { /* Style the sidebar */
                width: 275px;
                min-width: 190px;
                {% comment %} height: 81vh; {% endcomment %}
                float: left; /* Float sidebar to the left */
                font-family: Arial;
                color: #02253a;
                background-color: #02253a;
                overflow-y: auto;
                overflow-x: hidden;
                padding: 10px;
                border: solid;
                border-width: 6px;
                border-color: #02253a;
                border-radius:20px;
                margin:6px;
                position: relative;
        }




        /* Style the content inside the sidebar */
        #sidebar-content {
            {% comment %} margin-top: -20px; {% endcomment %}
            {% comment %} padding: 10px; {% endcomment %}
        }

        .filter {
            {% comment %} margin-bottom: 10px; {% endcomment %}
            {% comment %} padding: 8px; {% endcomment %}
            font-family: acumin-pro-extra-condensed,sans-serif;
            margin-left: -10px;
            margin-right: -10px;
            background-color:#027bcf;
        }
        .filter h4:hover {
            background-color: #0e6bc7;
        }
        .filter h4 {
            cursor: pointer;
            {% comment %} margin-bottom: 5px; {% endcomment %}
            color: #02253a;
            position: relative;
            padding: 12px;

        }

        .filter h4::after {
            content: var(--after-content, "");
            float: right;
            position: absolute;
            right: 12px;
        }

        .filter.show h4::after {
            content: var(--after-content, "\25AC");
        }

        .filter.hide h4::after {
            content: var(--after-content, "\25BC");
        }

        .filter.show {
            {% comment %} border: solid {% endcomment %}
        }

        .filter.hide {
            border: none
        }
        .filter-content {
            display: none;
            padding: 10px;
            color: #02253a;
            text-align: center;
        }
        .fh4.show {
            background-color: #027bcf;
        }
        .fh4.hide {
            background-color: #027bcf;
        }
        .filter-content.show {
            display: block;
            font-size: 12px;
            background-color: #2f9cdb;
            overflow-y: auto;
            max-height: 800px;

        }


        /* Style smaller checkboxes */
        .filter input[type="checkbox"] {
            transform: scale(0.75);
            margin-right: 5px;
        }

        /* Button style */
        .filter-content button {
            margin-top:5px;
            {% comment %} width: 49%; {% endcomment %}
            font-size: 12px;
            cursor: pointer;
        }

        .selectionContainer {
            background-color: #02253a;
            color: #a3cf5f;
            max-height: 33vh;
            padding: 0px;
            border-radius: 5px;
            margin-bottom:2px;
            overflow-y: auto;
            display: grid;
            grid-template-rows: max-content;
        }
        .button-container {
            display: none;
            padding-top: 8px;
            padding-bottom: 8px;
            justify-content: left;
            color: #02253a;
            position: relative;
            background-color: white;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            border-bottom-left-radius: 10px;
            border-bottom-right-radius: 10px; 
            overflow: auto;
            max-height: 24vh;
            min-height: auto;
        
        }
        .filterbutton {
            width: 100%;
            text-rendering: auto;
            color: black;
            letter-spacing: normal;
            word-spacing: normal;
            line-height: normal;
            text-transform: none; 
            {% comment %} text-indent: 10px; {% endcomment %}
            text-shadow: none; 
            display: grid;
            text-align: center;
            align-items: flex-start; 
            cursor: default;
            box-sizing: border-box; 
            background-color: white;
            margin: 0em;
            padding-block: 2px; 
            padding-inline: 2px; 
            border-width: 2px; 
            border-style: none;
            border-color: buttonborder; 
            border-image: initial; 
        }
        .filterbutton:hover {
            background-color: #a3cf5f;
            cursor: pointer;
        }
        .highlightbutton {
            width: 100%;
            text-rendering: auto;
            color: black;
            letter-spacing: normal;
            word-spacing: normal;
            line-height: normal;
            text-transform: none; 
            {% comment %} text-indent: 30px; {% endcomment %}
            text-shadow: none; 
            display: grid;
            text-align: center;
            align-items: flex-start; 
            cursor: default;
            box-sizing: border-box; 
            background-color: #b2ddf4;
            margin: 0em;
            padding-block: 2px; 
            padding-inline: 2px; 
            border-width: 2px; 
            border-style: none;
            border-color: buttonborder; 
            border-image: initial; 
        }
        .highlightbutton:hover {
            background-color: rgb(255, 0, 0);
            color: white;
        }
        .dropdownbutton {
            background-color: #a3cf5f;
            color: #02253a;
            {% comment %} border-radius: 5px; {% endcomment %}
            width: 100%;
            border-color: #a3cf5f;
            padding: 6px;
            {% comment %} display: inline-flex; {% endcomment %}
            align-items: center;
            {% comment %} justify-content: space-between; {% endcomment %}
            gap: 10px; /* space between text and arrow */
        }
        .dropdownbutton.notyet:hover {
            cursor: not-allowed;
        }
        .dropdownapplybutton {
            background-color: #02253a;
            color: white;
            {% comment %} border-radius: 5px; {% endcomment %}
            width: 100%;
            {% comment %} border-color: #02253a; {% endcomment %}
            {% comment %} padding: 2px; {% endcomment %}
            border: none;
        }
        .dropdownapplybutton:hover {
            cursor: pointer;
        }
        .selbutton {
            background-color: #ffffff;
            border-radius: 3px;
            padding: 5px;
            margin: 2px;
            color: #025687;
        }
        .selbutton:hover {
            {% comment %} background-color: red; {% endcomment %}
            {% comment %} color: white; {% endcomment %}
            cursor: pointer;
        }
        .divbtns {
            background-color:white;
            color:#02253a;
            border:none;
            padding: 4px;
            border-radius: 6px;
        }
        .divbtns:hover {
            cursor: pointer;
        }

        .pagebtn {
            background-color:white;
            color:#02253a;
            border:none;
            padding: 4px;
            margin-left:2px;
            margin-right: 2px;
            border-radius: 6px;
        }
        .pagebtn:hover {
            cursor: pointer;
            background-color: #d4dadc;
        }

        .alert {
            padding: 20px;
            background-color: #f44336;
            color: white;
        }
        .alert.hide {
            display: none,
        }
        .alert.show {
            padding: 20px;
            background-color: #f44336;
            color: white;
        }
        .closebtn {
            margin-left: 15px;
            color: white;
            font-weight: bold;
            float: right;
            font-size: 22px;
            line-height: 20px;
            cursor: pointer;
            transition: 0.3s;
        }
        
        .closebtn:hover {
            color: black;
        }

        .arrow {
            border: solid black;
            border-width: 0 3px 3px 0;
            display: inline-block;
            padding: 3px;
        }
        .up {
            transform: rotate(-135deg);
            -webkit-transform: rotate(-135deg);
        }
        
        .down {
            transform: rotate(45deg);
            -webkit-transform: rotate(45deg);
        }
        #dlbutton {
            display: none;
            width: 100%;
        } 
        #pbutton {
            display: none;
            width: 100%;
        } 
        {% comment %} .dropdownbutton::after {
            transform: rotate(45deg);
            content: '\2BFE'; /* Down arrow Unicode */
            font-size: 16px;       /* Increase size */
            font-weight: bold;     /* Make bold */
            position: relative;
            top: -4px; /* Move arrow up */
            margin-right:10px;
            margin-left:10px;
        } {% endcomment %}
        .refine {
            display:block
        }
        .refine.hidden {
            display:none
        }

        .image-container {
            width: 300px;
            height: 200px;
            border: 2px solid #000;
            text-align: center;
            margin: 20px;
        }
        .tabbtn {
        color:white;
        background-color:#025687;
        margin-top:-14px;
        border:none;
        font-weight: bold;
        }
        .tabbtn:hover {
        background-color:#006199;
        cursor: pointer;
        }
        .tabbtn.sel {
        background-color: #02253a;
        cursor:arrow;
        }
        .tabbtn.sel:hover {
        cursor: default;
        }
        .tabpanel.show {
        display:block;
        }
        .tabpanel.hide {
        display:none
        }
        .catgrid {
            margin-top:6vh;
            min-height:40vh;
            display:grid;
            grid-template-columns:50% 50%;
            grid-template-rows:50% 50%
        }
        .catgrid.show {
        display:block;
        }
        .catgrid.hide {
        display:none
        }
        /* HTML: <div class="loader"></div> */
        .loader {
        width: 50px;
        aspect-ratio: 1;
        display: grid;
        border-radius: 50%;
        background:
            linear-gradient(0deg ,rgb(0 0 0/50%) 30%,#0000 0 70%,rgb(0 0 0/100%) 0) 50%/8% 100%,
            linear-gradient(90deg,rgb(0 0 0/25%) 30%,#0000 0 70%,rgb(0 0 0/75% ) 0) 50%/100% 8%;
        background-repeat: no-repeat;
        animation: l23 1s infinite steps(12);
        }
        .loader::before,
        .loader::after {
        content: "";
        grid-area: 1/1;
        border-radius: 50%;
        background: inherit;
        opacity: 0.915;
        transform: rotate(30deg);
        }
        .loader::after {
        opacity: 0.83;
        transform: rotate(60deg);
        }
        @keyframes l23 {
        100% {transform: rotate(1turn)}
        }
        .loadingobjects {
            display:grid;
            justify-content:center
        }
        .ovdrop{
            background-color:white;
            color:black
        }
        .ovdrop:hover {
            color:red
        }

        .dim {
            color:lightgray
        }
        .dim:hover {
            cursor: not-allowed;
        }
        /* Apply progress cursor when loading */
        .loadinglayer {
          cursor: not-allowed;
        }

        .bigbox {
            height:98%;
            width:98%;
            padding: 5px;
            border: 2px solid #02253a;
            
        }

        .legend-triangle {
            display: inline-block;
            width: 0;
            height: 0;
            border-left: 4px solid transparent;
            border-right: 4px solid transparent;
            border-bottom: 8px solid red; 
            margin-right: 6px;
            vertical-align: middle;
        }
        .triangle-marker {
            width: 0;
            height: 0;
            border-left: 4px solid transparent;
            border-right: 4px solid transparent;
            {% comment %} border-bottom: 8px solid #0287D4; {% endcomment %}
            transition: transform 0.2s ease;
          }
        .square {
            width: 8px;
            height: 8px;
            background: blue;
          }
        .legend-diamond {
            display: inline-block;
            width: 7px;
            height: 7px;
            background: purple;
            transform: rotate(45deg);
            transition: transform 0.2s ease;
        }
        .diamond-marker {
            width: 8px;
            height: 8px;
            background: purple;
            transform: rotate(45deg);
            transition: transform 0.2s ease;
        }
        .pentagon-marker {
            width: 8px;
            height: 8px;
            background: crimson;
            clip-path: polygon(50% 0%, 100% 38%, 82% 100%, 18% 100%, 0% 38%);
            transition: transform 0.2s ease;
          }
          .legend-pentagon {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: crimson;
            clip-path: polygon(50% 0%, 100% 38%, 82% 100%, 18% 100%, 0% 38%);
            transition: transform 0.2s ease;
          }
          .hexagon-marker {
            width: 8px;
            height: 8px;
            background: teal;
            clip-path: polygon(
              25% 0%, 75% 0%,
              100% 50%, 75% 100%,
              25% 100%, 0% 50%
            );
            transition: transform 0.2s ease;
          }
          .legend-hexagon {
            display: inline-block;

            width: 8px;
            height: 8px;
            background: teal;
            clip-path: polygon(
              25% 0%, 75% 0%,
              100% 50%, 75% 100%,
              25% 100%, 0% 50%
            );
            transition: transform 0.2s ease;
          }
          .plus-marker {
            width: 8px;
            height: 8px;
            background: teal;
            clip-path: polygon(
              35% 0%, 65% 0%, 
              65% 35%, 100% 35%, 
              100% 65%, 65% 65%, 
              65% 100%, 35% 100%, 
              35% 65%, 0% 65%, 
              0% 35%, 35% 35%
            );
            transition: transform 0.2s ease;
          }
          
          .legend-plus {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: teal;
            clip-path: polygon(
              35% 0%, 65% 0%, 
              65% 35%, 100% 35%, 
              100% 65%, 65% 65%, 
              65% 100%, 35% 100%, 
              35% 65%, 0% 65%, 
              0% 35%, 35% 35%
            );
            transition: transform 0.2s ease;
          }
          .tooltip {
            position: fixed;
            background: #333;
            color: #fff;
            padding: 6px 10px;
            border-radius: 4px;
            font-size: 12px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.1s ease;
          }
          .tool2tip {
            position: fixed;
            background: #333;
            color: #fff;
            padding: 6px 10px;
            border-radius: 4px;
            font-size: 12px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.1s ease;
            z-index: 50000000;
          }
          input::placeholder {
            color: #999; /* lighter gray */
            opacity: 1;  /* optional, for full visibility in some browsers */
          }
          .custom-square-marker {
            width: 14px;
            height: 14px;
            border: 2px solid red;
            background-color: transparent;
            box-sizing: border-box;
            border-radius: 0; /* keep it square */
          }
          .filterbutton {
            text-align: left;
            white-space: nowrap; /* Keeps text on one line */
          }
          
          .bold-part {
            font-weight: bold;
            margin-right: 4px; /* Optional spacing */
          }
          
          .normal-part {
            font-weight: normal;
          }

          .legend {
            display: flex;
            flex-direction: column;
            max-height: 100%;
            width: 300px; /* or whatever your desired width is */
            background: white;
            border: 1px solid #ccc;
        }
        
        .legend-header {
            display: grid;
            grid-auto-flow: dense;
            background: #f9f9f9;
            padding: 5px;
            flex-shrink: 0;
        }
        
        .legend-scrollable {
            overflow-y: auto;
            max-height: calc(100% - 30px); /* Adjust 30px if your header is taller/shorter */
        }
        
        .legend-content {
            padding: 10px;
        }

        #sort-field2 {
            background-color: #a3cf5f;  /* green "button" */
            color: #02253a;
            border: 1px solid #a3cf5f;
            padding: 5px;
            appearance: none; /* removes default OS style in most browsers */
            -webkit-appearance: none;
            -moz-appearance: none;
          }
        
          /* Style the dropdown options */
          #sort-field2 option {
            background-color: white;  
            color: #000000;

          }
          .splash-modal {
            display: none;
            position: fixed;
            z-index: 9999;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.6);
          }
        
          .splash-content {
            max-width: 1000px;
            width: 80%;
            height: 80%;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%); /* center both horizontally and vertically */
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            font-family: 'Archivo Black', sans-serif;
            color: #02253a;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            display: flex;
            flex-direction: column;
            justify-content: space-between; /* keeps top content and bottom tabs spaced out */
          }
          
          .enter-button {
            display:none;
            height: 50px;
            width: 100px;
            background-color: #a3cf5f;
            color: #02253a;
            font-weight: bold;
            font-size:16px;
            border:none;
            border-radius:6px;
            cursor: pointer;
          }
          .enter-button.enabled {
            display:block;
            opacity: 1;
            pointer-events: auto;
          }
          .close-button {
            display:none;
            position: absolute;
            top: 15px;
            right: 20px;
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
          }
        
          .close-button:hover {
            color: #000;
          }
        
          .close-button.enabled {
            display: block;
            pointer-events: auto;
          }

          .checkbox-agree:hover{
            cursor: pointer;
          }

          .tab-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: auto;
            border-top: 1px solid #ccc;
            padding-top: 15px;
          }
        
          .tab-buttons button {
            flex: 1;
            margin: 0 5px;
            background-color: #02253a;
            color: white;
            border: none;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Archivo Black', sans-serif;
          }
        
          .tab-buttons button:hover {
            background-color: #035;
          }
        
          .tab-content {
            min-height: 150px;
          }
    </style>
</head>
<body>
    <div class="container" >
        <header style="display: flex; justify-content: space-between; margin-left: -10px; padding: 10px 20px;">
            <div style="display: flex; align-items: center;">
                <a href="https://www.fractracker.org/" target="_blank" style="text-decoration: none;">
                    <img class="header-image" style="font-family:Archivo Black; margin-top:10px; height:90px; width:90px; position: relative; z-index: 5100;" src="/static/images/ft2021_logo_icon_dark_blue_med.png">
                </a>
                <h1 style="font-family:Archivo Black; margin-top:4px; margin-left: 20px; color:#02253a; line-height:1; font-size:45px;">
                    Petrochemical<br>Data Portal
                </h1>
            </div>
        
            <div style="display: flex; gap: 10px;margin: 16px 10px">
                <button onclick="openSplash()"
                        style="font-family: 'Archivo Black'; background-color: #02253a; color: white; border: none; padding: 10px 22px; border-radius: 5px; cursor: pointer;">
                    About&nbsp;&nbsp;❯
                </button>
                <a href="https://www.fractracker.org/data/" target="_blank" style="text-decoration: none;">
                    <button style="font-family: 'Archivo Black'; background-color: #ffc857; color: #02253a; border: none; padding: 16px 22px; border-radius: 5px; cursor: pointer;">
                      More Data&nbsp;&nbsp;❯
                    </button>
                </a>
            </div>
        </header>

        <div class="main-content">
            <div class="left" style="margin-top:0">
                <div id="tabbtns" style="display:grid;grid-template-columns: 40% 60%;height: 5vh">
                    <button class="tabbtn sel" id="resultsbtn" style="border-top-left-radius:20px;margin-left:-12px;font-family:arial">Facility<br>Data</button>
                    <button class="tabbtn " id="filterbtn" style="border-top-right-radius:20px;margin-right:-12px;font-family:arial">Summary of<br>Demographics</button>
                </div>

                <div class=" tabpanel hide" id="filterpanel" style="color:white"> {% comment %} class was class="catgrid tabpanel" {% endcomment %}
                    <div id="attributes-box" style="position: relative; padding: 10px; margin-top: 40px; border-radius: 5px;">
                        {% comment %} <h3>Demographics of the population within </h3> {% endcomment %}
                        <p>Load a layer onto the map and click a feature in the map to see the population demographics within 1km of your facility.</p>
                    </div>
                </div>
                <div class="tabpanel " id="filterpanel2"  style="display:none">

                    <div class="filter toggle-wellstatus hide" style="display:none">
                        <h4 class="fh4" id="wellstatush4" onclick="toggleFilter('wellstatus')">WELL STATUS</h4>
                        <div class="filter-content wellstatus-content" id="statusContainer">
                            <div class="selectionContainer" id="statusPicks" style="max-height:14vh">Status varies from state to state, take a look at the reference below.</div>
                            <button class="dropdownbutton notyet" id="statusbutton" onclick="openlist('wellstatus')">Well Status<br></button>
                            <div class="button-container" id="status-container"></div>
                        </div>
                    </div>
                    <div class="filter toggle-welltype hide" style="display:none">
                        <h4 class="fh4" id="welltypeh4" onclick="toggleFilter('welltype')">WELL TYPE</h4>
                        <div class="filter-content welltype-content" id="typeContainer">
                            <div class="selectionContainer" id="typePicks" style="max-height:14vh">Type varies from state to state, take a look at the reference below.</div>
                            <button class="dropdownbutton notyet" id="typebutton" onclick="openlist('welltype')">Types Available<br></button>
                            <div class="button-container" id="type-container"></div>
                        </div>
                    </div>

                    <div class="filter toggle-ftacat hide" style="display:none">
                        <h4 class="fh4" id="ftacath4" onclick="toggleFilter('ftacat')">FRACTRACKER CATEGORY</h4>
                        <div class="filter-content ftacat-content" id="ftacatContainer">
                            <div class="selectionContainer" id="ftacatPicks" style="max-height:14vh">Our attempt to normalize the varying classifications across the country. </div>
                            <button class="dropdownbutton notyet" id="ftacatbutton" onclick="openlist('welltype')">General Classification<br></button>
                            <div class="button-container" id="ftacat-container"></div>
                        </div>
                    </div>

                </div>
                <div class="tabpanel hide" id="loadingpanel">
                    <div class="loadingobjects">
                        <div id="loadingtext" style="font-weight:bold;margin-top:60px;margin-bottom:20px">
                            Retrieving your records
                        </div>
                        <div id="spinnerid" class="loader" style="margin:auto"></div>
                    </div>
                </div>
                <div class="tabpanel " id="resultspanel">
                    <div id="postapply"  style="margin-top:30px">
                        <div class="refine" id="refineblock">
                            <div class="filter" style="cursor: default;">  {% comment %} toggle-states show"> {% endcomment %} 
                                <h4 class="fh4 show" style="cursor: default;font-family:Archivo;color:white;background-color:#02253a;padding-left:12px;padding-bottom:0px" id="statesh4" onclick="toggleFilter('states')">Select Data</h4>
                                <div class="filter-content states-content show" id="filterState" style="background-color:#02253a">
                                    {% comment %} <label for="stateinputbox" style="display:block;padding-bottom: 5px;"></label> {% endcomment %}
                                    <div class="selectionContainer" style="display:none;justify-content:center" id="datasetSelection"></div>
                                    <button class="dropdownbutton" id="statebutton" style="border-radius:6px;align-content:center" onclick="openlist('state')">Select</button>
                                    <div class="button-container" id="state-container" style="border-top-left-radius:10px;border-top-right-radius:10px;border-top-left-radius:10px;border:4px solid #a3cf5f"></div>
                                    <div style="display: flex; align-items: center; justify-content: flex-start; gap: 8px; margin-top: 5px;">
                                        <input type="checkbox" id="addtomap" style="transform: scale(1.04);accent-color:#ffc857;">
                                        <label for="addtomap" style="color:white; position: relative; top: 2px;left:-6px">Add to the map</label>
                                      </div>
                                </div>
                            </div>
                            <div class="filter toggle-counties hide" style="display:none">
                                <h4 class="fh4" id="countiesh4" onclick="toggleFilter('counties')">COUNTY</h4>
                                <div class="filter-content counties-content hide" id="ctyFilterContainer">
                                    <div class="selectionContainer" id="countyPicks" style="max-height:14vh">You can limit your results to those within a specific county by clicking the corresponding button below.</div>
                                    <button class="dropdownbutton notyet" id="countybutton" onclick="openlist('county')">Counties by State<br></button>
                                    <div class="button-container" id="county-container"></div>
                                </div>
                            </div>

                            <div id="search" style="margin-top:15px;color:white">
                                <label style="font-family:Archivo;"><b>Filter</b></label>
                                <select id="sort-field2" style="border-radius:6px;cursor:pointer;text-align:center;padding: 5px;margin-top:10px;margin-bottom:14px" class="dropdownbutton">
                                    <option value=""style="color:#8a8a8a" selected>Select</option> <!-- Placeholder option -->
                                </select>
                                {% comment %} <div style="display:grid;grid-template-columns:84% 16%;width:100%"> {% endcomment %}
                                <div>
                                    <div class="tool2tip-target" style="z-index:50000;text-align:center;border:none;height:25px;background-color:#0287D4;border-radius:4px"><input id="srch-input1" placeholder="Refine by keyword..." style="text-indent:5px;border:none;border-radius:4px;height:25px;width:100%"></input></div>
                                    {% comment %} <input style="width:120px;text-align: right;" type="number" id="sort-input" placeholder="Jump to page #" min="1"> {% endcomment %}
                                    {% comment %} <div style="justify-self:right;text-align:center;border:none;height:25px;background-color:white;border-radius:7px"><button id="sortbtn2" class="divbtns" onclick="refinefilter()">Go</button></div> {% endcomment %}
                                </div>    
                                <div style="display: flex; gap: 5px; align-items: center;margin-top:5px">
                                    <div style="text-align: center; border: solid; height: 25px; background-color: #02253a; border-color:white;border-width:1px;border-radius: 7px;width:50%">

                                    {% comment %} <div style="text-align: center; border: none; height: 25px; background-color: white; border-radius: 7px;width:50%"> {% endcomment %}
                                        <button class="divbtns" style="background-color:transparent;border-color:#02253a;color:white" onclick="clearFilter()">Reset</button>
                                    </div>
                                    <div style="text-align: center; border: none; height: 25px; background-color: white; border-radius: 7px;width:50%">

                                    {% comment %} <div style="text-align: center; border: solid; height: 25px; background-color: #00253B; border-color:red;border-width:2px;border-radius: 7px;width:50%"> {% endcomment %}
                                        <button id="sortbtn2" class="divbtns" onclick="refinefilter()">Search</button>
                                    </div>

                                </div>

                            </div>
                            <div class="controls" style="position: absolute; bottom: 87px; left: 10px; right: 10px;">
                                {% comment %} <button class="print-btn" onclick="showPrintPreview()">📋 Create Map Screenshot</button> {% endcomment %}
                                <button class="divbtns" id="pbutton" style="font-family: 'Archivo Black'; font-size:18px;height: 60px; display: block; background-color: #ffc857;" onclick="showPrintPreview()"><i class="fa-solid fa-print"></i> Print Map</button>
                            </div>
                            {% comment %} <div class="dlbtn" style="position: absolute; bottom: 87px; left: 10px; right: 10px;">
                                <button class="divbtns" id="pbutton" style="font-family: 'Archivo Black'; font-size:18px;height: 60px; display: block; background-color: #ffc857;" onclick="printMap()"><i class="fa-solid fa-print"></i> Print Map</button>
                            </div> {% endcomment %}
                            <div class="dlbtn" style="position: absolute; bottom: 10px; left: 10px; right: 10px;">
                                <button class="divbtns" id="dlbutton" style="font-family: 'Archivo Black'; font-size:18px;height: 60px; display: block; background-color: #ffc857;" onclick="downloadTableData(thetabledata)">
                                    Download
                                    <span style="font-size: 20px; display: inline-block; transform: rotate(270deg); margin-left: 8px;">&#8676;</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="right" id="container" style="min-width:650px">
                <!-- Top content of the right side -->
                
                <div id="map" style="border-top-left-radius: 20px;">
                    {% comment %} <img class="header-image" style="height: 60px;position: absolute; right: 10px;z-index: 5100;" src="/static/images/ft2021_logo_icon dark_blue.png"> {% endcomment %}

                    <div class="legend" id="legend" style="width:auto;overflow:auto;max-height:calc(100% - 30px)">
                        <div class="legend-header" id="legend-toggle">
                            <div  style="justify-self:left">
                                <span id="legend_arrow">x</span>
                            </div>
                            <div style="justify-self:center">
                                <span>Map Layers</span>
                            </div>
                        </div>
                        <div class="legend-scrollable">
                            <div class="legend-content">
                                <div id="custom-tooltip" class="tooltip">Coming Soon!</div>
                                <div id="custom-tool2tip" class="tool2tip">Try using &nbsp;&nbsp;*<br> as a wildcard.</div>
                                <div style="display: flex; justify-content: center; cursor: default;">
                                    <p style="margin-bottom: 5px; margin-left: 10px; cursor: default;">
                                      Available Data
                                      <button 
                                        onclick="openDD()" 
                                        id="info-btn" 
                                        style="
                                          margin-left: 4px; 
                                          padding: 2px 6px; 
                                          font-size: 12px; 
                                          cursor: pointer; 
                                          border: none; 
                                          background-color: transparent;
                                        "
                                      >
                                        <i class="fas fa-info-circle"></i>
                                      </button>
                                    </p>
                                  </div>
                                <p style="margin-bottom:5px;margin-top:10px"><strong>Market Hubs, Ports, Terminals</strong></p>
                                <div class="legenditem " id="legenditemid_58"><label class="category1 " id="legenditemid_68"><span class="legend-diamond" style="background: #000000; margin-right:5px;"></span><input type="checkbox" id="eia_terminal_crudeoil" class=""  unchecked> Crude Oil (Terminal)</label></div>
                                <div class="legenditem " id="legenditemid_35"><label class="category1 " id="legenditemid_45"><span class="legend-diamond" style="background: #0287D4; margin-right:5px;"></span><input type="checkbox" id="eia_markethub_hgl" class="legenditemchk"  unchecked> HGL (Market Hub)</label></div>
                                <div class="legenditem " id="legenditemid_59"><label class="category1 " id="legenditemid_69"><span class="legend-diamond" style="background: #FFC857; margin-right:5px;"></span><input type="checkbox" id="eia_terminal_lng" class=""  unchecked> LNG (Terminal)</label></div>
                                <div class="legenditem " id="legenditemid_36"><label class="category1 " id="legenditemid_46"><span class="legend-diamond" style="background: #00253B; margin-right:5px;"></span><input type="checkbox" id="eia_markethub_naturalgas" class="legenditemchk"  unchecked> Natural Gas (Market Hub)</label></div>
                                <div class="legenditem " id="legenditemid_57"><label class="category1 " id="legenditemid_67"><span class="legend-diamond" style="background: #de541e; margin-right:5px;"></span><input type="checkbox" id="eia_storage_naturalgas" class=""  unchecked> Natural Gas (Underground Storage)</label></div>
                                <div class="legenditem " id="legenditemid_55"><label class="category1 " id="legenditemid_65"><span class="legend-diamond" style="background: #e052e2; margin-right:5px;"></span><input type="checkbox" id="eia_ports_petroleum" class="legenditemchk"  unchecked> Petroleum (Port)</label></div>
                                <div class="legenditem " id="legenditemid_56"><label class="category1 " id="legenditemid_66"><span class="legend-diamond" style="background: #5d792f; margin-right:5px;"></span><input type="checkbox" id="eia_reserve_petroleum" class=""  unchecked> Petroleum (Reserve)</label></div>
                                <div class="legenditem " id="legenditemid_70"><label class="category1 " id="legenditemid_80"><span class="legend-diamond" style="background: red; margin-right:5px;"></span><input type="checkbox" id="eia_terminal_petroleum" class=""  unchecked> Petroleum (Terminal)</label></div>
                                <p style="margin-bottom:5px"><strong>Compressor Stations</strong></p>
                                <div class="legenditem " id="legenditemid_34"><label class="category1 " id="legenditemid_44"><span class="legend-triangle" style="transform: rotate(180deg);border-bottom-color: #de541e; margin-right:5px;"></span><input type="checkbox" id="eia_compressorstations" class=""  unchecked> Compressor Station</label></div>
                                <p style="margin-bottom:5px"><strong>Plants</strong></p>
                                <div class="legenditem " id="legenditemid_38"><label class="category1 " id="legenditemid_48"><span class="legend-pentagon" style="background: #00253B; margin-right:5px;"></span><input type="checkbox" id="eia_plants_biodiesel" class="legenditemchk"  unchecked> Biodiesel</label></div>
                                <div class="legenditem " id="legenditemid_39"><label class="category1 " id="legenditemid_49"><span class="legend-pentagon" style="background: #0287D4; margin-right:5px;"></span><input type="checkbox" id="eia_plants_ethanol" class="legenditemchk"  unchecked> Ethanol</label></div>
                                <div class="legenditem " id="legenditemid_50"><label class="category1 " id="legenditemid_60"><span class="legend-pentagon" style="background: #e052e2; margin-right:5px;"></span><input type="checkbox" id="eia_plants_ethylene_cracker" class="legenditemchk"  unchecked> Ethylene Cracker</label></div>
                                <div class="legenditem " id="legenditemid_37"><label class="category1 " id="legenditemid_47"><span class="legend-pentagon" style="background: #a3cf5f; margin-right:5px;"></span><input type="checkbox" id="plants_fertilizer" class="legenditemchk"  unchecked> Fertilizer</label></div>
                                <div class="legenditem " id="legenditemid_75"><label class="category1 " id="legenditemid_85"><span class="legend-pentagon" style="background: #de541e; margin-right:5px;"></span><input type="checkbox" id="eia_plants_processing_naturalgas" class=""  unchecked> Natural Gas (Processing)</label></div>
                                <div class="legenditem " id="legenditemid_76"><label class="category1 " id="legenditemid_86"><span class="legend-pentagon" style="background: #000000; margin-right:5px;"></span><input type="checkbox" id="eia_plants_refinery_petroleum" class=""  unchecked> Petroleum (Refinery)</label></div>
                                <p style="margin-bottom:5px"><strong>Power Plants</strong></p>
                                <div class="legenditem " id="legenditemid_51"><label class="category1 " id="legenditemid_61"><span class="legend-plus" style="background: #00253B; margin-right:5px;"></span><input type="checkbox" id="eia_powerplants_batterystorage" class="legenditemchk"  unchecked> Battery Storage</label></div>
                                {% comment %} <div class="legenditem tooltip-target" id="legenditemid_37"><label class="category1 dim" id="legenditemid_47"><span class="legend-plus" style="background: #de02d3; margin-right:5px;"></span><input type="checkbox" id="plants_fertilizer" class="legenditemchk"  unchecked> Fertilizer</label></div> {% endcomment %}
                                <div class="legenditem " id="legenditemid_52"><label class="category1 " id="legenditemid_62"><span class="legend-plus" style="background: #000000; margin-right:5px;"></span><input type="checkbox" id="eia_plants_coal" class="legenditemchk"  unchecked> Coal</label></div>
                                <div class="legenditem " id="legenditemid_53"><label class="category1 " id="legenditemid_63"><span class="legend-plus" style="background: #5d792f; margin-right:5px;"></span><input type="checkbox" id="eia_plants_geothermal" class="legenditemchk"  unchecked> Geothermal</label></div>
                                <div class="legenditem " id="legenditemid_54"><label class="category1 " id="legenditemid_64"><span class="legend-plus" style="background: #0287D4; margin-right:5px;"></span><input type="checkbox" id="eia_plants_hydroelectric" class="legenditemchk"  unchecked> Hydroelectric</label></div>
                                <div class="legenditem " id="legenditemid_71"><label class="category1 " id="legenditemid_81"><span class="legend-plus" style="background: #e052e2; margin-right:5px;"></span><input type="checkbox" id="eia_plants_hydropumped" class="legenditemchk"  unchecked> Hydro Pumped Storage</label></div>
                                <div class="legenditem " id="legenditemid_72"><label class="category1 " id="legenditemid_82"><span class="legend-plus" style="background: #de541e; margin-right:5px;"></span><input type="checkbox" id="eia_plants_power_naturalgas" class="legenditemchk"  unchecked> Natural Gas</label></div>
                                <div class="legenditem " id="legenditemid_73"><label class="category1 " id="legenditemid_83"><span class="legend-plus" style="background: #FFC857; margin-right:5px;"></span><input type="checkbox" id="eia_plants_nuclear" class="legenditemchk"  unchecked> Nuclear</label></div>
                                <div class="legenditem " id="legenditemid_74"><label class="category1 " id="legenditemid_84"><span class="legend-plus" style="background: #ff0000; margin-right:5px;"></span><input type="checkbox" id="eia_plants_petroleum" class=""  unchecked> Petroleum</label></div>

                                {% comment %} <div class="legenditem " id="legenditemid11"><label class="category1 dim" id="legenditemid21"><input type="checkbox" id="category1" class="dim" unchecked><img src="../static/images/cat1.png" style='height:17px;width:19px;margin-right:2px;margin-left:-6px'>Injection / Storage / Service</label></div>
                                <div class="legenditem " id="legenditemid12"><label class="category1 dim" id="legenditemid22"><input type="checkbox" id="category2" class="dim" unchecked><img src="../static/images/cat2.png" style='height:17px;width:19px;margin-right:2px;margin-left:-6px'> Not Drilled</label></div>
                                <div class="legenditem " id="legenditemid13"><label class="category1 dim" id="legenditemid23"><input type="checkbox" id="category3" class="dim" unchecked><img src="../static/images/cat3.png" style='height:17px;width:19px;margin-right:2px;margin-left:-6px'> Orphaned / Abandoned / Unverified Plug</label></div>
                                <div class="legenditem " id="legenditemid14"><label class="category1 dim" id="legenditemid24"><input type="checkbox" id="category4" class="dim" unchecked><img src="../static/images/cat4.png" style='height:17px;width:19px;margin-right:2px;margin-left:-6px'> Other / Unknown</label></div>
                                <div class="legenditem " id="legenditemid15"><label class="category1 dim" id="legenditemid25"><input type="checkbox" id="category5" class="dim" unchecked><img src="../static/images/cat5.png" style='height:17px;width:19px;margin-right:2px;margin-left:-6px'> Plugged</label></div>
                                <div class="legenditem " id="legenditemid16"><label class="category1 dim" id="legenditemid26"><input type="checkbox" id="category6" class="dim"  unchecked><img src="../static/images/cat6.png" style='height:17px;width:19px;margin-right:2px;margin-left:-6px'> Production Well</label></div> {% endcomment %}
                                <p style="margin-bottom:5px"><strong>Border Crossings</strong></p>
                                <div class="legenditem " id="legenditemid_31"><label class="category1 " id="legenditemid_41"><span class="legend-triangle" style="border-bottom-color: #5d792f; margin-right:5px;"></span><input type="checkbox" id="eia_bordercrossing_electric" class="legenditemchk"  unchecked> Electric Transmission Lines</label></div>
                                <div class="legenditem " id="legenditemid_32"><label class="category1 " id="legenditemid_42"><span class="legend-triangle" style="border-bottom-color: #00253B; margin-right:5px;"></span><input type="checkbox" id="eia_bordercrossing_liquids" class="legenditemchk"  unchecked> Liquid Pipelines</label></div>
                                <div class="legenditem " id="legenditemid_33"><label class="category1 " id="legenditemid_43"><span class="legend-triangle" style="border-bottom-color: #de541e; margin-right:5px;"></span><input type="checkbox" id="eia_bordercrossing_naturalgas" class="legenditemchk"  unchecked> Natural Gas Pipelines</label></div>
                                <p style="margin-bottom:5px"><strong>Pipelines</strong></p>
                                <div class="legenditem " id="legenditemid_12"><label class="category1 " id="legenditemid_22"><span style ="color:#e052e2;font-weight:bold;position:relative; top: -8px;left:6px;font-size:x-large;transform:rotate(50deg)">_</span><input type="checkbox" id="pipeline_fta" class=""  unchecked> FracTracker Pipelines</label></div>
                                <div class="legenditem " id="legenditemid_12"><label class="category1 " id="legenditemid_22"><span style ="color:#00253B;font-weight:bold;position:relative; top: -8px;left:6px;font-size:x-large;transform:rotate(50deg)">_</span><input type="checkbox" id="pipeline_crudeoil" class=""  unchecked> Crude Oil</label></div>
                                <div class="legenditem " id="legenditemid_13"><label class="category1 " id="legenditemid_23"><span style ="color:#0287D4;font-weight:bold;position:relative; top: -8px;left:6px;font-size:x-large;transform:rotate(50deg)">_</span><input type="checkbox" id="pipeline_hgl" class=""  unchecked> HGL</label></div>
                                <div class="legenditem " id="legenditemid_14"><label class="category1 " id="legenditemid_24"><span style ="color:#de541e;font-weight:bold;position:relative; top: -8px;left:6px;font-size:x-large;transform:rotate(50deg)">_</span><input type="checkbox" id="pipeline_naturalgas" class=""  unchecked> Natural Gas</label></div>
                                <div class="legenditem " id="legenditemid_15"><label class="category1 " id="legenditemid_25"><span style ="color:#a3cf5f;font-weight:bold;position:relative; top: -8px;left:6px;font-size:x-large;transform:rotate(50deg)">_</span><input type="checkbox" id="pipeline_petroleum" class=""  unchecked> Petroleum</label></div>
                                {% comment %} <div class="legenditem tooltip-target" id="legenditemid_11"><label class="category1 dim " id="legenditemid_21"><span style ="color:#de02d3;font-weight:bold;position:relative; top: -8px;margin-right:5px">_</span><input type="checkbox" id="pipeline_fractracker" class="dim"  unchecked> FracTracker Digitized</label></div> {% endcomment %}
                                <div <span style ="color:white;font-weight:bold;position:relative; top: -8px;margin-right:5px">_</span><p type="checkbox" id="pipeline_fractracker" class="dim"  > </p></label></div>

                                {% comment %} <div class="legenditem " id="legenditemid17"><label class="category1 dim" id="legenditemid27"><input type="checkbox" id="countylayer" class="dim"  unchecked> County Borders</label></div>
                                <div class="legenditem " id="legenditemid18"><label class="category1 dim" id="legenditemid28"><input type="checkbox" id="countycount" class="dim"  unchecked> County Counts</label></div>
                                <div class="legenditem " id="legenditemid19"><label class="category1 dim" id="legenditemid29"><input type="checkbox" id="countychoropleth" class="dim"  unchecked> County Choropleth</label></div> {% endcomment %}
                            </div>
                        </div>
                    </div>
                </div>
                <div class="divider" id="dividerContainer" style="z-index: 1000;margin-top:-12px">
                    <div>
                        <div style="padding:9px;display:grid;grid-auto-flow:column;">
                            <div>
                                <div>
                                    <input style="border:none;width:148px;text-align:center;height:25px;background-color:white;border-radius:7px" type="number" id="page-input" placeholder="Jump to page #" min="1">
                                    <button class="divbtns" onclick="goToPage()">Go</button>
                                </div>

                                {% comment %} <div class="pagenav-container" style="justify-self:center">
                                    <span id="pagination" style="justify-self: center"></span>
                                </div> {% endcomment %}
                            </div>
                            <div style="color:white;margin-top:2px;justify-self:center">
                                <span id="tabledataset"></span>
                            </div> 
                            <div style="justify-self:right">
                                <!-- Dropdown with a placeholder-like option for "Sort by" -->
                                <select id="sort-field" style="text-align:center;border:none;height:25px;background-color:white;border-radius:7px">
                                </select>
                                {% comment %} <input style="width:120px;text-align: right;" type="number" id="sort-input" placeholder="Jump to page #" min="1"> {% endcomment %}
                                <button id="sortbtn" class="divbtns" onclick="sortTable()">Sort</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="bottom" id="bottomContainer" style="margin-top:-4px;background-color:#02253a;border:4px solid #02253a;margin-bottom:5px;border-bottom-left-radius:18px;border-bottom-right-radius:18px;">
                <!-- Bottom content of the right side -->
                <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                    <!-- Left-aligned -->
                    <div id="pagination" style="flex: 1; text-align: left;">
                        <!-- Pagination controls go here -->
                    </div>
                
                    <!-- Centered -->
                    <div style="flex: 1; text-align: center; color: white; margin-top: 2px;">
                        <span id="records"></span>
                    </div>
                    <!-- Optional: Right-aligned space filler -->
                    <div style="flex: 1;"></div>
                </div>
                    <div class="tablecontainer">
                        <!-- Grid container for the table -->
                        <table id="maintable">
                            <thead id="maintableheader" class="sticky-header-container">
                            </thead>
                            <tbody id="maintablebody">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        {% comment %} <div style="display: flex; justify-content: right; gap: 20px;margin-bottom:5px;margin-right:5px">
            <a href="https://www.fractracker.org/" target="_blank">
                <img class="header-image"
                     style="font-family:Archivo Black; margin-top:10px; height:40px; width:160px; position: relative; z-index: 5100;"
                     src="/static/images/fraccloseSplashtrackerlogodark.png"
                     alt="Beyond Petrochemicals">
            </a>
            <a href="https://www.beyondpetrochemicals.org/" target="_blank">
                <img class="header-image"
                     style="font-family:Archivo Black; margin-top:10px; height:40px; width:160px; position: relative; z-index: 5100;"
                     src="/static/images/beyondpetrochemicalslogo2.png"
                     alt="Beyond Petrochemicals">
            </a>
        </div> {% endcomment %}
    </div>

    <!-- Print Preview Modal -->
    <div id="printModal" class="print-modal">
        <div class="print-content">
            <button class="close-btn" onclick="closePrintPreview()">&times;</button>
            <div class="print-header">
                <h2>Map Preview</h2>
                <p>Date: <span id="printDate"></span></p>
            </div>
            <div id="printMap" class="print-map"></div>
            <div class="print-actions">
                {% comment %} <div class="controls" style="position: absolute; bottom: 87px; left: 10px; right: 10px;"> {% endcomment %}
                    {% comment %} <button class="print-btn" onclick="showPrintPreview()">📋 Create Map Screenshot</button> {% endcomment %}
                <button class="screenshot-btn" onclick="captureMapScreenshot()"><i class="fa-solid fa-print"></i> Print Map</button>
                {% comment %} <button class="screenshot-btn" onclick="captureMapScreenshot()">📸 Download Screenshot</button> {% endcomment %}
                <button class="print-btn" onclick="closePrintPreview()">Cancel</button>
            </div>
        </div>
    </div>
    <!-- Splash Modal -->
    <div id="splashScreen" class="splash-modal">
        <div class="splash-content">
        <span class="close-button" onclick="closeSplash()" id="closex">&times;</span>
    
        <!-- Main Content Area (changes when tabs are clicked) -->
        <div id="tabContent" class="tab-content" style="overflow-y:auto">
            <h2>Welcome</h2>
            <p>This is the default content shown in the modal.</p>
        </div>
    
        <!-- Tab Buttons -->
        <div class="tab-buttons">
            <button disabled onclick="showTab('tab1')" class="btn" id="btn1" >Terms of Service</button>
            {% comment %} <button onclick="showTab('tab2')">Quick Guide</button> {% endcomment %}
            <button disabled onclick="showTab('tab3')" class="btn" id="btn2" >Data Details</button>
        </div>
    {% comment %} </div> {% endcomment %}
    </div>
    <!-- Include Project Specific JavaScript -->
    <script src = "/static/js/wells.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <script>

        

        let printMapInstance;


        // Screenshot preview function
        function showPrintPreview() {
            const modal = document.getElementById('printModal');
            const printDate = document.getElementById('printDate');
            
            // Set current date
            printDate.textContent = new Date().toLocaleDateString();
            
            // Show modal
            modal.style.display = 'block';
            
            // Create print map instance with better layer handling
            setTimeout(() => {
                if (printMapInstance) {
                    printMapInstance.remove();
                }
                
                printMapInstance = L.map('printMap').setView(map.getCenter(), map.getZoom());
                
                // Find the current tile layer from the main map
                let originalTileLayer;

                map.eachLayer(layer => {
                    if (layer instanceof L.TileLayer && !(layer instanceof L.ImageOverlay)) {
                        originalTileLayer = layer;
                    }
                });

                let tileLayer;
                if (originalTileLayer) {
                    tileLayer = L.tileLayer(originalTileLayer._url, {
                        ...originalTileLayer.options
                    }).addTo(printMapInstance);
                } else {
                    // Fallback to OpenStreetMap if no tile layer found
                    tileLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                        attribution: '© OpenStreetMap contributors',
                        maxZoom: 19
                    }).addTo(printMapInstance);
                }
                
                // Wait for base tiles to load
                let tilesLoaded = 0;
                let tilesToLoad = 0;
                
                tileLayer.on('tileloadstart', function() {
                    tilesToLoad++;
                });
                
                tileLayer.on('tileload', function() {
                    tilesLoaded++;
                });
                
                tileLayer.on('tileerror', function() {
                    tilesLoaded++;
                });
                
                // Copy all layers from original map with full styling
                map.eachLayer(function(layer) {
                    if (layer instanceof L.Marker) {
                        // Copy marker with all options including custom icons
                        const newMarker = L.marker(layer.getLatLng(), {
                            icon: layer.options.icon,
                            opacity: layer.options.opacity,
                            ...layer.options
                        }).addTo(printMapInstance);
                        if (layer.getPopup()) {
                            newMarker.bindPopup(layer.getPopup().getContent());
                        }
                    } else if (layer instanceof L.Polyline && !(layer instanceof L.Polygon)) {
                        // Handle polylines with full styling
                        const newPolyline = L.polyline(layer.getLatLngs(), {
                            color: layer.options.color,
                            weight: layer.options.weight,
                            opacity: layer.options.opacity,
                            fillColor: layer.options.fillColor,
                            fillOpacity: layer.options.fillOpacity,
                            dashArray: layer.options.dashArray,
                            lineCap: layer.options.lineCap,
                            lineJoin: layer.options.lineJoin,
                            ...layer.options
                        }).addTo(printMapInstance);
                        if (layer.getPopup()) {
                            newPolyline.bindPopup(layer.getPopup().getContent());
                        }
                    } else if (layer instanceof L.Polygon) {
                        // Handle polygons with full styling
                        const newPolygon = L.polygon(layer.getLatLngs(), {
                            color: layer.options.color,
                            weight: layer.options.weight,
                            opacity: layer.options.opacity,
                            fillColor: layer.options.fillColor,
                            fillOpacity: layer.options.fillOpacity,
                            dashArray: layer.options.dashArray,
                            lineCap: layer.options.lineCap,
                            lineJoin: layer.options.lineJoin,
                            ...layer.options
                        }).addTo(printMapInstance);
                        if (layer.getPopup()) {
                            newPolygon.bindPopup(layer.getPopup().getContent());
                        }
                    } else if (layer instanceof L.Circle) {
                        // Handle circles with full styling
                        const newCircle = L.circle(layer.getLatLng(), {
                            radius: layer.getRadius(),
                            color: layer.options.color,
                            weight: layer.options.weight,
                            opacity: layer.options.opacity,
                            fillColor: layer.options.fillColor,
                            fillOpacity: layer.options.fillOpacity,
                            dashArray: layer.options.dashArray,
                            ...layer.options
                        }).addTo(printMapInstance);
                        if (layer.getPopup()) {
                            newCircle.bindPopup(layer.getPopup().getContent());
                        }
                    } else if (layer instanceof L.CircleMarker && !(layer instanceof L.Circle)) {
                        // Handle circle markers with full styling
                        const newCircleMarker = L.circleMarker(layer.getLatLng(), {
                            radius: layer.options.radius,
                            color: layer.options.color,
                            weight: layer.options.weight,
                            opacity: layer.options.opacity,
                            fillColor: layer.options.fillColor,
                            fillOpacity: layer.options.fillOpacity,
                            ...layer.options
                        }).addTo(printMapInstance);
                        if (layer.getPopup()) {
                            newCircleMarker.bindPopup(layer.getPopup().getContent());
                        }
                    } else if (layer instanceof L.GeoJSON) {
                        // Handle GeoJSON layers with styling
                        const newGeoJSON = L.geoJSON(layer.toGeoJSON(), {
                            style: layer.options.style,
                            pointToLayer: layer.options.pointToLayer,
                            onEachFeature: layer.options.onEachFeature,
                            filter: layer.options.filter,
                            coordsToLatLng: layer.options.coordsToLatLng,
                            ...layer.options
                        }).addTo(printMapInstance);
                    } else if (layer instanceof L.LayerGroup) {
                        // Handle layer groups recursively
                        const newLayerGroup = L.layerGroup();
                        layer.eachLayer(function(subLayer) {
                            // Recursively add sublayers with styling
                            if (subLayer instanceof L.Marker) {
                                const newSubMarker = L.marker(subLayer.getLatLng(), {
                                    icon: subLayer.options.icon,
                                    opacity: subLayer.options.opacity,
                                    ...subLayer.options
                                });
                                if (subLayer.getPopup()) {
                                    newSubMarker.bindPopup(subLayer.getPopup().getContent());
                                }
                                newLayerGroup.addLayer(newSubMarker);
                            }
                            // Add other sublayer types as needed
                        });
                        newLayerGroup.addTo(printMapInstance);
                    } else if (layer instanceof L.ImageOverlay) {
                        // Handle image overlays
                        const newImageOverlay = L.imageOverlay(
                            layer._url,
                            layer.getBounds(),
                            {
                                opacity: layer.options.opacity,
                                alt: layer.options.alt,
                                interactive: layer.options.interactive,
                                crossOrigin: layer.options.crossOrigin,
                                errorOverlayUrl: layer.options.errorOverlayUrl,
                                zIndex: layer.options.zIndex,
                                className: layer.options.className,
                                ...layer.options
                            }
                        ).addTo(printMapInstance);
                    }
                    // Note: TileLayer is handled separately above
                });
                
                // Ensure the print map renders properly
                setTimeout(() => {
                    printMapInstance.invalidateSize();
                    
                    // Enable screenshot button once everything is loaded
                    setTimeout(() => {
                        const screenshotBtn = document.querySelector('.screenshot-btn');
                        if (screenshotBtn) {
                            screenshotBtn.disabled = false;
                            screenshotBtn.innerHTML = '<i class="fa-solid fa-print"></i> Print Map';

                        }
                    }, 1000);
                }, 200);
            }, 100);
        }
        
        // Close screenshot preview
        function closePrintPreview() {
            document.getElementById('printModal').style.display = 'none';
            if (printMapInstance) {
                printMapInstance.remove();
                printMapInstance = null;
            }
        }
        function captureMapScreenshot() {
            const captureButton = document.querySelector('.screenshot-btn');
            const originalText = captureButton.textContent;
            const title = document.querySelector('.print-header h2');
            const printActions = document.querySelector('.print-actions');
            const closeButton = document.querySelector('.close-btn');
            const originalTitle = title.textContent;
        
            // Update title and hide buttons
            title.textContent = 'FracTracker Data Portal';
            printActions.style.display = 'none';
            closeButton.style.display = 'none';
        
            // Show waiting cursor
            document.body.style.cursor = 'wait';
        
            setTimeout(() => {
                if (printMapInstance) {
                    printMapInstance.invalidateSize();
                }
        
                setTimeout(() => {
                    const printContent = document.querySelector('.print-content');
        
                    html2canvas(printContent, {
                        useCORS: true,
                        allowTaint: true,
                        scale: 2,
                        logging: false,
                        width: printContent.offsetWidth,
                        height: printContent.offsetHeight,
                        backgroundColor: '#ffffff',
                        foreignObjectRendering: false,
                        imageTimeout: 15000,
                        onclone: function(clonedDoc) {
                            const images = clonedDoc.querySelectorAll('img');
                            images.forEach(img => {
                                if (!img.complete) {
                                    img.onload = function() {};
                                }
                            });
                        }
                    }).then(function(canvas) {
                        // Ask user for filename
                        let userInput = prompt("Enter a filename for your download:", "fractracker-dataportal-map");
                        if (!userInput) {
                            userInput = "fractracker-dataportal-map";
                        }
        
                        // Sanitize filename (remove invalid characters)
                        userInput = userInput.replace(/[^a-z0-9_\-\.]/gi, '_').toLowerCase();
        
                        // Add date to filename
                        const filename = `${userInput}.png`;
        
                        const link = document.createElement('a');
                        link.download = filename;
                        link.href = canvas.toDataURL('image/png');
        
                        document.body.appendChild(link);
                        link.click();
                        document.body.removeChild(link);
        
                        // Reset UI
                        title.textContent = originalTitle;
                        printActions.style.display = 'block';
                        closeButton.style.display = 'block';
                        document.body.style.cursor = 'default';
        
                        showMessage('Screenshot saved successfully!', 'success');
                        setTimeout(() => {
                            closePrintPreview();
                        }, 1000);
        
                    }).catch(function(error) {
                        console.error('Screenshot failed:', error);
        
                        // Reset UI
                        title.textContent = originalTitle;
                        printActions.style.display = 'block';
                        closeButton.style.display = 'block';
                        captureButton.disabled = false;
                        captureButton.textContent = originalText;
                        document.body.style.cursor = 'default';
        
                        showMessage('Screenshot failed. Please try again.', 'error');
                    });
                }, 1500);
            }, 500);
        }
        
        
        // Show temporary message
        function showMessage(text, type) {
            const message = document.createElement('div');
            message.textContent = text;
            message.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 12px 24px;
                border-radius: 4px;
                color: white;
                font-weight: bold;
                z-index: 10001;
                ${type === 'success' ? 'background-color: #4CAF50;' : 'background-color: #f44336;'}
            `;
            
            document.body.appendChild(message);
            
            setTimeout(() => {
                document.body.removeChild(message);
            }, 3000);
        }
        
        // Wait for tiles to load before enabling screenshot
        function waitForTilesToLoad() {
            const printButtons = document.querySelectorAll('.print-btn');
            
            // Disable buttons initially
            printButtons.forEach(btn => {
                btn.disabled = true;
                btn.textContent = btn.textContent.replace('📋', '⏳');
            });
            
            // Re-enable after a short delay to allow tiles to load
            setTimeout(() => {
                printButtons.forEach(btn => {
                    btn.disabled = false;
                    btn.textContent = btn.textContent.replace('⏳', '📋');
                });
            }, 2000);
        }



        // Function to toggle filter visibility
        function toggleFilter(filterName) {
            let list = ['counties','wellstatus','welltype','ftacat']


            list.forEach(element => {
                var filterContent = document.querySelector('.' + element + '-content');
                var filterBox = document.querySelector('.toggle-' + element);
                var filterIcon = document.querySelector('.filter.toggle-' + element + ' h4');
                var filterH4 = document.getElementById(element + 'h4')
                console.log('element')
                console.log(element)
                console.log(element !== "states")
                if (element === filterName ) {
                    if (filterContent.classList.contains('show')) {
                        filterContent.classList.remove('show');
                        filterContent.classList.add('hide');
                        filterBox.style.border = 'none';
                        filterH4.classList.remove('show');
                        filterH4.classList.add('hide');
                        filterIcon.style.setProperty('--after-content', '"\\25BC"');
                    } else {
                    filterContent.classList.add('show');
                    filterContent.classList.remove('hide');
                    filterH4.classList.add('show');
                    filterH4.classList.remove('hide');
                    filterIcon.style.setProperty('--after-content', '"\\25AC"');
                    }
                } else {
                    filterContent.classList.remove('show');
                    filterContent.classList.add('hide');
                    filterH4.classList.remove('show');
                    filterH4.classList.add('hide');
                    filterIcon.style.setProperty('--after-content', '"\\25BC"');
                }
            })


        }
        function openSplash() {
            document.getElementById("splashScreen").style.display = "block";
            showTab('tab1'); // Show default tab content
          }
        
        function closeSplash() {
            document.getElementById("splashScreen").style.display = "none";
          }
        function openDD() {
            document.getElementById("splashScreen").style.display = "block";
            showTab('tab3'); // Show default tab content
          }
        
        function closeDD() {
            document.getElementById("splashScreen").style.display = "none";
          }



        function showTab(tabId) {
            const content = {
              tab1: {
                title: 'Welcome to our Petrochemical Data Portal',
                text: `<br>This application was developed to provide key insights into petrochemical data across the United States by FracTracker Alliance.<br>`+
                       `<br>© Copyright 2025 `+
                       `<a href="https://www.fractracker.org" target="_blank" rel="noopener noreferrer">FracTracker Alliance</a><br>`+
                       `<br>The FracTracker data available to the public on this web page is subject to the following terms and conditions:<br><br>`+
                       `<div style="font-size:13px;font-weight:normal;font-family:arial;margin-left:20px">1. The Site and App are provided on an “as is” basis without warranties or representations of any kind, either express or implied, including, but not limited to, warranties of title or implied warranties of merchantability or fitness for a particular purpose. <br>2. In no event shall FracTracker be liable for any special, direct, indirect, consequential, or incidental damages or any damages whatsoever arising out of or in connection with the use of the Site and App or the contents of the Site and App.<br>3. FracTracker Alliance retains all rights, title, and interest in and to the Data compilation, the database structure, and the Portal itself, including all associated intellectual property rights. The license granted herein is strictly limited to the uses permitted under these Terms.<br>4. A core condition of using the Data is that your use must be consistent with and supportive of the mission of FracTracker Alliance. Our mission is to "map, analyze, and communicate the risks of oil, gas, and petrochemical development to advance just energy alternatives that protect public health, natural resources, and the climate." We reserve the right, <strong>in our sole discretion</strong>, to determine whether a particular use is consistent with our mission.<br>5. When using the Data in any public-facing materials, you must cite FracTracker Alliance as the source.<br>6. By using the Site and/or App, you agree to our <a href="https://www.fractracker.org/terms-of-service/" target="_blank" rel="noopener noreferrer">Terms of Service</a> (“Terms”) and our <a href="https://www.fractracker.org/privacy-policy/" target="_blank" rel="noopener noreferrer">Privacy Policy</a> (“Privacy Policy”).</div>` +
                       `<button class="enter-button" id="enter-btn" style="margin-top:24px" onclick="closeSplash()">Enter</button>`+
                       `<br><label><input type="checkbox" class ="checkbox-agree" id="splash-checkbox"> <strong>I agree to the terms</strong></label>`
              },
              
              tab3: {
                title: 'Data Sourcing',
                text:
                `<br><span><b>In need of background information? </b></span><a href="https://www.fractracker.org/petrochemicals/guide/" target="_blank" rel="noopener noreferrer">Petrochemical Basics</a><br>`+
                `<br><span><b>Help Us Improve the FracTracker Data Portals:</b></span> <a href="https://forms.gle/NQ7QLRCm4HYm1SXF8" target="_blank" rel="noopener noreferrer">Feedback Form</a>`+
                '<br><br><b>MARKET HUBS, PORTS and TERMINALS</b>'+
                '<br><br><u>Crude Oil (Terminal)</u> – <i>These terminals facilitate the loading and unloading of crude oil, often connecting different modes of transportation like rail and pipelines. Data from EIA. Updated 8/01/2025.</i>'+
                '<br><br><u>HGL (Market Hub)</u> - <i>Hydrocarbon gas liquids (HGL) storage and trading hubs. Data from EIA. Updated 8/01/2025.</i>'+
                '<br><br><u>LNG (Terminal)</u> - <i>Liquefied natural gas import/export terminals – Facilities that can a) liquefy natural gas so it is ready to be exported as liquefied natural gas (LNG) and/or b) re-gasify LNG so it can be used as natural gas. Natural gas is transported in a liquid state because it takes up less space as a liquid than as a gas. Data from EIA. Updated 8/01/2025.</i>'+
                '<br><br><u>Natural Gas (Market Hub)</u> – <i>Natural Gas trading hubs. Data from the EIA. Updated 8/01/2025.</i>'+
                '<br><br><u>Natural Gas (Underground Storage)</u> – <i>Data from the EIA. Updated 8/01/2025.</i>'+
                '<br><br><u>Petroleum (Port)</u> – <i>A port that can import and/or export 200,000 or more short tons of petroleum products a year. Data from the EIA 8/01/2025.</i>'+
                '<br><br><u>Petroleum (Terminals)</u> – <i>“All operable bulk petroleum product terminals in the United States with a total bulk shell storage capacity of 50,000 barrels or more, and/or ability to receive volumes from tanker, barge, or pipeline. Survey locations adjusted using public data.” Data from the EIA. Updated 8/01/2025.</i>'+
                '<br><br><u>Compressor stations</u> – <i>facilities that pressurize natural gas to keep it flowing through a pipeline. Data from HIFLD. Updated 7/01/2024.</i>'+
                '<br><br><br><br><b>PLANTS</b>'+
                '<br><br><u>Biodiesel</u> – <i>facilities that produce biodiesel, a renewable, clean-burning diesel fuel substitute made from various plant oils, animal fats, and recycled cooking grease. Data from EIA. Updated 8/01/2025.</i>'+
                '<br><br><u>Ethanol</u> – <i>facility that produces ethanol, a biofuel made by fermenting and distilling grains or other starchy materials. Data from EIA. Updated 8/01/2025.</i>'+
                '<br><br><u>Ethylene Crackers</u> – <i>plants that “crack” ethane (a natural gas liquid)  into ethylene. Data from EIA. Updated 8/01/2025.</i>'+
                '<br><br><u>Fertilizer</u> – <i>Nitrogen and phosphorus producing plants and mines. Updated 11/1/2023.</i>'+
                '<br><br><u>Natural Gas (Processing)</u> – <i>Facilities that purify and refine raw natural gas, removing impurities and valuable liquids to produce pipeline-quality natural gas and other marketable products. Data from EIA. Updated 8/01/2025.</i>'+
                '<br><br><u>Petroleum (Refinery)</u> – <i>Data from EIA. Updated 8/01/2025.</i>'+
                '<br><br><br><br><b>POWER PLANTS</b>'+
                '<br><br><u>Battery Storage</u> – <i>Operable electric generating plants. Data from EIA. Updated 8/01/2025.</i>'+
                '<br><br><u>Coal</u> – <i>Operable electric generating plants. Data from EIA. Updated 8/01/2025.</i>'+
                '<br><br><u>Geothermal</u> – <i>Operable electric generating plants. Data from EIA. Updated 8/01/2025.</i>'+
                '<br><br><u>Hydroelectric</u> – <i>Operable electric generating plants. Data from EIA. Updated 8/01/2025.</i>'+
                '<br><br><u>Hydro Pumped Storage</u> – <i>Operable electric generating plants. Data from EIA. Updated 8/01/2025.</i>'+
                '<br><br><u>Natural Gas</u> – <i>Operable electric generating plants. Data from EIA. Updated 8/01/2025.</i>'+
                '<br><br><u>Petroleum</u> – <i>Operable electric generating plants. Data from EIA. Updated 8/01/2025.</i>'+
                '<br><br><u>Electric Transmission Lines</u> – <i>Operable electric generating plants. Data from EIA. Updated 8/01/2025.</i>'+
                '<br><br><u>Liquid Pipelines</u> – <i>Operable electric generating plants. Data from EIA. Updated 8/01/2025.</i>'+
                '<br><br><u>Natural Gas Pipelines</u> – <i>Operable electric generating plants. Data from EIA. Updated 8/01/2025.</i>'+
                '<br><br><br><br><b>PIPELINES</b>'+
                '<br><br><u>Recent Pipeline Projects</u> – <i>data compiled by FracTracker Alliance from various online sources. Updated 3/29/2025.</i>'+
                '<br><br><u>Crude Oil Pipelines</u> – <i>major crude oil pipelines, including interstate trunk lines and selected intrastate lines, not including gathering lines. Data from EIA. Updated 8/01/2025.</i>'+
                '<br><br><u>HGL Pipelines</u> – <i>Hydrocarbon gas liquid pipelines (aka natural gas liquid (NGL) pipelines). Data from EIA. Updated 8/01/2025.</i>'+
                '<br><br><u>Natural Gas Pipelines</u> – <i>Data from EIA. Updated 8/01/2019.</i>'+
                '<br><br><u>Petroleum Product Pipelines</u> - <i>Major petroleum product pipelines. Data from EIA. Updated 8/01/2025.</i>'
            }
        };
      
        // Enable or disable the button based on checkbox state



        const tabContent = document.getElementById("tabContent");
        tabContent.innerHTML = `<h2>${content[tabId].title}</h2><p style="font-family:arial">${content[tabId].text}</p>`;
      



        // ✅ Only attach checkbox logic if this is tab1
        if (tabId === 'tab1') {
            const checkbox = document.getElementById('splash-checkbox');
            const enterBtn = document.getElementById('enter-btn');
            const close_x = document.getElementById('closex');
            const btn1 = document.getElementById('btn1');
            const btn2 = document.getElementById('btn2');
          
            // Restore checkbox state from sessionStorage
            const savedState = sessionStorage.getItem('splashCheckboxChecked');
            if (savedState === 'true') {
              checkbox.checked = true;
              enterBtn.classList.add('enabled');
              close_x.classList.add('enabled');
              btn1.classList.add('active');
              btn2.classList.add('active');
            }
          
            checkbox.addEventListener('change', function () {
              sessionStorage.setItem('splashCheckboxChecked', checkbox.checked);
          
              if (checkbox.checked) {
                enterBtn.classList.add('enabled');
                close_x.classList.add('enabled');
                btn1.disabled=false;
                btn2.disabled=false;

              } else {
                enterBtn.classList.remove('enabled');
                close_x.classList.remove('enabled');
                btn1.disabled=true;
                btn2.disabled=true;
              }
            });
          }
      }
      document.addEventListener('DOMContentLoaded', () => {
        const mcheckbox = document.getElementById('splash-checkbox');
    
        // Restore state on load (within session)
        if (sessionStorage.getItem('modalCheckboxChecked') === 'true') {
          mcheckbox.checked = true;
        }
    
        // Update state when checkbox is clicked
        mcheckbox.addEventListener('change', () => {
          sessionStorage.setItem('modalCheckboxChecked', mcheckbox.checked);
        });
      });
      
      document.addEventListener('DOMContentLoaded', () => {
        const splashScreen = document.getElementById('splashScreen');
    
        splashScreen.addEventListener('click', function (e) {
          // Only block if click is directly on the background overlay
          if (e.target === splashScreen) {
            console.log('Overlay clicked - do nothing');
            // Prevent accidental modal close
            e.stopPropagation();
          } else {
            console.log('Clicked inside modal content');
          }
        });
      });


        // ✅ Show modal on load
        window.addEventListener('DOMContentLoaded', () => {
            const splash = document.getElementById("splashScreen");
            splash.style.display = "block"; // show modal

            // Load tab1 content
            showTab('tab1');
        });

        // ✅ Close modal if clicked outside
        window.onclick = function (event) {
            const splash = document.getElementById("splashScreen");
            if (event.target === splash) {
            splash.style.display = "none";
            }
        };
        window.addEventListener('beforeunload', function () {
            sessionStorage.clear();
          });

        document.addEventListener('DOMContentLoaded', () => {
        const isMobile = /Mobi|Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) 
                        || window.innerWidth <= 768;
        
        if (isMobile) {
            console.log("Mobile device detected, for a more user friendly experience rotate your device so that it's horizontal");
        } else (
            console.log("Likely a desktop")
        )
        });

        window.addEventListener("beforeprint", () => {
            if (map && map.invalidateSize) {
              setTimeout(() => {
                map.invalidateSize();
              }, 100);
            }
          });
        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('printModal');
            if (event.target === modal) {
                closePrintPreview();
            }
        };
</script>
</body>
</html>
